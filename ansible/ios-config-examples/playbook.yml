---

- name: Deploy NetDev Config
  hosts: r1
  gather_facts: no
  connection: local

  vars_files:
    - "/etc/ansible/group_vars/connection.yml"
    - "/etc/ansible/group_vars/config.yml"

  tasks:
    - name: deploy commands from play list
      ios_config:
        commands:
          - int lo1
        provider: "{{ ios_provider }}"

    - name: deploy from jinger2 template
      ios_config:
        src: "/home/rick/development/ansible/templates/config.j2"
        provider: "{{ ios_provider }}"
      tags: config-j2

    - name: generate config file
      template: src="/home/rick/development/ansible/templates/config.j2" dest="/home/rick/development/ansible/configs/config-auto.cfg"
      tags: build
      register: out

    - name: deploy from auto generated file
      ios_config:
        src: "/home/rick/development/ansible/configs/config-auto.cfg"
        provider: "{{ ios_provider }}"
      tags: deploy

    - debug:
        msg: "{{ out }}"
