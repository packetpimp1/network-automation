# create fork
FAIL_SNAPSHOT_NAME = "spine1-failure-snapshot"
bf_fork_snapshot(BASE_SNAPSHOT_NAME, FAIL_SNAPSHOT_NAME, deactivate_nodes=["spine1"], overwrite=True)

# diff reach quest
diff_reach_answer = bfq.differentialReachability(
        headers=HeaderConstraints(dstIps='server2')
    ).answer(
        snapshot=FAIL_SNAPSHOT_NAME,
        reference_snapshot=BASE_SNAPSHOT_NAME
    ).frame()

# run scripts
python3 -i scripts/chaos_monkey.py "nxos9k-ebgp-spine-leaf/snapshot-2"

# troubleshoot
# 1. routes
bfq.routes(nodes="leaf1").answer().frame()

# 2. ospf interfaces
bfq.interfaceProperties(nodes="/leaf|spine/", properties="OSPF_Enabled|OSPF_Passive|Description").answer().frame().dropna()

# 3. ospf interface (ospf enabled)
ospf_interfaces = bfq.interfaceProperties(nodes="/leaf|spine/", properties="OSPF_Enabled|OSPF_Passive|Description").answer().frame().dropna()
ospf_interfaces[ospf_interfaces['OSPF_Enabled'] != True]

# rerun monkey
python3 -i scripts/chaos_monkey.py "nxos9k-ebgp-spine-leaf/snapshot-3"
